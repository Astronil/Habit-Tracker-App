var e=globalThis,t={},i={},n=e.parcelRequire94c2;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in i){var n=i[e];delete i[e];var o={id:e,exports:{}};return t[e]=o,n.call(o.exports,o,o.exports),o.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){i[e]=t},e.parcelRequire94c2=n),n.register;var o=n("6AR8M"),a=n("gdelx"),l=n("ku4mm");const r=(0,o.getAuth)(),s=(0,a.getDatabase)(),c=new l.BiometricAuth;function d(){document.getElementById("loadingOverlay").style.display="block"}function m(){document.getElementById("loadingOverlay").style.display="none"}function u(e,t=!1){let i=document.getElementById("toast");i.textContent=e,i.style.backgroundColor=t?"var(--error)":"var(--success)",i.style.display="block",setTimeout(()=>{i.style.display="none"},3e3)}document.addEventListener("DOMContentLoaded",async()=>{await c.init(),console.log("Document loaded, initializing Firebase...");let e=document.getElementById("googleBtn"),t=document.getElementById("registerForm"),i=document.getElementById("registerBtn"),n=document.getElementById("loginForm"),l=document.getElementById("biometricBtn"),g=document.getElementById("registerModal"),h=document.querySelectorAll(".closeModalBtn");n.addEventListener("submit",async e=>{e.preventDefault(),d();let t=document.getElementById("email").value,i=document.getElementById("password").value;try{await (0,o.signInWithEmailAndPassword)(r,t,i),sessionStorage.getItem("loggedIn")?window.location.pathname.includes("index.html")&&(window.location.href="habits.html"):window.location.pathname.includes("index.html")||(window.location.href="index.html")}catch(e){console.error("Login error:",e),u(e.message,!0)}finally{m()}}),t.addEventListener("submit",async e=>{e.preventDefault(),d();let t=document.getElementById("regName").value,i=document.getElementById("regEmail").value,n=document.getElementById("regPassword").value;if(n!==document.getElementById("confirmPassword").value){u("Passwords do not match",!0),m();return}try{let e=await (0,o.createUserWithEmailAndPassword)(r,i,n);await (0,o.updateProfile)(e.user,{displayName:t}),await (0,a.update)((0,a.ref)(s,`users/${e.user.uid}`),{name:t,email:i,createdAt:Date.now()}),c.available?(console.log("Starting biometric registration..."),await c.register(e.user.uid,t,i,n),console.log("Biometric registration complete"),await (0,a.update)((0,a.ref)(s,`biometricUsers/${e.user.uid}`),{email:i,password:n})):console.log("Biometric authentication not available on this device."),u("Account created successfully!"),setTimeout(()=>{sessionStorage.getItem("loggedIn")?window.location.pathname.includes("index.html")&&(window.location.href="habits.html"):window.location.pathname.includes("habits.html")||(window.location.href="index.html")},1e3)}catch(e){console.error("Registration error:",e),u(e.message,!0)}finally{m()}}),e.addEventListener("click",async()=>{console.log("Google sign-in button clicked."),d();let e=new o.GoogleAuthProvider;try{let t=await (0,o.signInWithPopup)(r,e);console.log("Google sign-in successful:",t),await (0,a.update)((0,a.ref)(s,`users/${t.user.uid}`),{name:t.user.displayName,email:t.user.email,lastLogin:Date.now()}),sessionStorage.getItem("loggedIn")?window.location.pathname.includes("index.html")&&(window.location.href="habits.html"):window.location.pathname.includes("habits.html")||(window.location.href="index.html")}catch(e){console.error("Google sign-in error:",e),u(`Google sign-in error: ${e.message}`,!0)}finally{m()}}),l.addEventListener("click",async()=>{if(console.log("Biometric authentication button clicked."),!c.available){u("Biometric authentication is not available",!0);return}d();try{let e=r.currentUser||JSON.parse(localStorage.getItem("lastUser"));if(!e)throw Error("Please sign in with email first to set up biometric authentication");let t=await c.authenticate(e.uid);if(console.log("Biometric authentication result:",t),t){let t=await (0,a.get)((0,a.ref)(s,`biometricUsers/${e.uid}`));if(t.exists()){let{email:e,password:i}=t.val();await (0,o.signInWithEmailAndPassword)(r,e,i),console.log("User signed in with stored credentials"),sessionStorage.getItem("loggedIn")?window.location.pathname.includes("index.html")&&(window.location.href="habits.html"):window.location.pathname.includes("habits.html")||(window.location.href="index.html")}else throw Error("Biometric user not found.")}else u("Biometric authentication failed",!0)}catch(e){console.error("Biometric authentication error:",e),u(`Biometric authentication error: ${e.message}`,!0)}finally{m()}}),i.addEventListener("click",()=>{g.style.display="block"}),h.forEach(e=>{e.addEventListener("click",()=>{g.style.display="none"})}),window.addEventListener("click",e=>{e.target===g&&(g.style.display="none")}),document.querySelectorAll(".toggle-password").forEach(e=>{e.addEventListener("click",()=>{let t=e.parentElement.querySelector("input"),i=e.querySelector("i");"password"===t.type?(t.type="text",i.textContent="visibility"):(t.type="password",i.textContent="visibility_off")})});let w=document.getElementById("regPassword"),y=document.querySelectorAll("[data-requirement]");w.addEventListener("input",()=>{let e=w.value;y.forEach(t=>{let i=t.dataset.requirement,n=!1;switch(i){case"length":n=e.length>=8;break;case"uppercase":n=/[A-Z]/.test(e);break;case"lowercase":n=/[a-z]/.test(e);break;case"number":n=/\d/.test(e)}t.style.color=n?"var(--success)":"var(--error)"})})});
//# sourceMappingURL=index.1467c5ac.js.map
